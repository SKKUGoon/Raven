syntax = "proto3";

package raven;

// Control service for managing data collection lifecycle
service Control {
    // Start collecting data for a specific symbol (forcibly)
    rpc StartCollection(ControlRequest) returns (ControlResponse);
    
    // Stop collecting data for a specific symbol
    rpc StopCollection(ControlRequest) returns (ControlResponse);
    
    // List all active collections with their status
    rpc ListCollections(ListRequest) returns (ListResponse);

    // Stop all active collections
    rpc StopAllCollections(StopAllRequest) returns (StopAllResponse);
}

message ControlRequest {
    string symbol = 1;   // e.g., "BTCUSDT"
    string exchange = 2; // Optional, used for validation if provided
}

message ControlResponse {
    bool success = 1;
    string message = 2;
}

message ListRequest {}

message ListResponse {
    repeated CollectionInfo collections = 1;
}

message CollectionInfo {
    string symbol = 1;
    string status = 2;     // "active", "error", etc.
    int32 subscriber_count = 3;
}

message StopAllRequest {}

message StopAllResponse {
    bool success = 1;
    string message = 2;
}
